!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=5)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",function(){return o});var o=function(){function t(e,n){r(this,t),this.x=e||0,this.y=n||0}return a(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"equals",value:function(t){return t&&this.x===t.x&&this.y===t.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"normalized",value:function(){var e=this.length();return 0===e?new t(0,0):new t(this.x/e,this.y/e)}},{key:"perpendicular",value:function(){return new t(-this.y,this.x)}},{key:"rotated",value:function(e){var n=Math.cos(e),r=Math.sin(e);return new t(n*this.x+r*this.y,-r*this.x+n*this.y)}},{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"perpDot",value:function(t){return this.x*t.y-this.y*t.x}},{key:"scale",value:function(e){return new t(this.x*e,this.y*e)}}]),t}()},function(t,e,n){"use strict";function r(t){return o(t)||a(t)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function o(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n.d(e,"a",function(){return h});var c=n(0),h=function(){function t(e,n,r,i){u(this,t),this.left=e||Number.POSITIVE_INFINITY,this.right=r||Number.NEGATIVE_INFINITY,this.top=n||Number.POSITIVE_INFINITY,this.bottom=i||Number.NEGATIVE_INFINITY}return l(t,[{key:"isEmpty",value:function(){return this.left>this.right||this.top>this.bottom}},{key:"width",value:function(){var t=this.right-this.left;return t>=0?t:NaN}},{key:"height",value:function(){var t=this.bottom-this.top;return t>=0?t:NaN}},{key:"center",value:function(){return new c.a(.5*(this.left+this.right),.5*(this.top+this.bottom))}},{key:"containsPoint",value:function(t){return this.left<=t.x&&t.x<=this.right&&this.top<=t.y&&t.y<=this.bottom}},{key:"containsPoints",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,a=t[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;if(!this.containsPoint(o))return!1}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return!0}},{key:"intersects",value:function(t){return this.left<=t.right&&this.right>=t.left&&this.top<=t.bottom&&this.bottom>=t.top}},{key:"translated",value:function(e){return new t(this.left+e.x,this.top+e.y,this.right+e.x,this.bottom+e.y)}}],[{key:"fromPoints",value:function(e){var n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return Array.isArray(e)?(n=Math.min.apply(Math,r(e.map(function(t){return t.x}))),i=Math.min.apply(Math,r(e.map(function(t){return t.y}))),a=Math.max.apply(Math,r(e.map(function(t){return t.x}))),o=Math.max.apply(Math,r(e.map(function(t){return t.y})))):(n=e.x,i=e.y,a=e.x,o=e.y),new t(n,i,a,o)}},{key:"fromAABBs",value:function(e){var n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return Array.isArray(e)?(n=Math.min.apply(Math,r(e.map(function(t){return t.left}))),i=Math.min.apply(Math,r(e.map(function(t){return t.top}))),a=Math.max.apply(Math,r(e.map(function(t){return t.right}))),o=Math.max.apply(Math,r(e.map(function(t){return t.bottom})))):(n=Math.min(n,aabb.left),i=Math.min(i,aabb.top),a=Math.max(a,aabb.right),o=Math.max(o,aabb.bottom)),new t(n,i,a,o)}}]),t}()},function(t,e,n){"use strict";function r(t){return o(t)||a(t)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function o(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n.d(e,"a",function(){return d});var c=n(9),h=n.n(c),f=n(0),y=n(1),p=n(3),v=function(t){return t.reduce(function(t,e){return t+e},0)/t.length},m=function(t,e,n,r){if(t>n)throw new Error("Right must be greater than Left");if(e>r)throw new Error("Bottom must be greater than Top")},d=function(){function t(e){u(this,t),this.vertices=e,this.recompute()}return l(t,[{key:"recompute",value:function(){var t=this.vertices;if(this.aabb=y.a.fromPoints(t),this.edges=[],this.normals=[],this.count=t.length,this.center=new f.a(v(t.map(function(t){return t.x})),v(t.map(function(t){return t.y}))),this.count>1)for(var e=0;e<this.count;e++){var n=(e+1)%this.count,r=t[n].sub(t[e]);this.edges.push(r);var i=r.normalized().perpendicular(),a=t[e].sub(this.center);a.dot(i)<0&&(i=i.scale(-1)),this.normals.push(i)}}},{key:"isValid",value:function(){if(this.count<4)return!0;for(var t=0,e=0;e<this.count;e++){var n=(e+1)%this.count,r=this.edges[e].perpDot(this.edges[n]);if(r*t<0)return!1;t=r}return!0}},{key:"projectOntoAxis",value:function(t){var e=new p.a,n=!0,r=!1,i=void 0;try{for(var a,o=this.vertices[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=u.dot(t);e.extendTo(s)}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e}},{key:"rotated",value:function(e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=this.vertices[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=s.clone().sub(this.center),c=l.rotated(e),h=this.center.add(c);n.push(h)}}catch(t){i=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return new t(n)}},{key:"translated",value:function(e){return new t(this.vertices.map(function(t){return t.add(e)}))}}],[{key:"fromRectangle",value:function(e,n,r,i){return m(e,n,r,i),new t([new f.a(e,n),new f.a(r,n),new f.a(r,i),new f.a(e,i)])}},{key:"fromCapsule",value:function(e,n,i,a,o){if(o<3)throw new Error("Specify at least 3 cap segments");m(e,n,i,a);var u=i-e;if(a-n<u)throw new Error("Capsule height must be larger than width");var s=.5*u,l=r(Array(o).keys()).map(function(t){return-t*Math.PI/o}),c=.5*(e+i),h=l.map(function(t){return new f.a(Math.cos(t),Math.sin(t)).scale(s)}),y=new f.a(c,n+s),p=h.map(function(t){return y.add(t)});p.push(new f.a(e,y.y));var v=new f.a(c,a-s);return p=p.concat(h.map(function(t){return v.sub(t)})),p.push(new f.a(i,v.y)),new t(p)}},{key:"generateConvexPolygons",value:function(e){var n=e.map(function(t){return[t.x,t.y]});return h.a.decomp(n).map(function(e){return new t(e.map(function(t){return new f.a(t[0],t[1])}))})}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",function(){return o});var o=function(){function t(){r(this,t),this.makeEmpty()}return a(t,[{key:"extendTo",value:function(t){this.min>t&&(this.min=t),this.max<t&&(this.max=t)}},{key:"containsPoint",value:function(t){return this.min<=t&&t<=this.max}},{key:"containsRange",value:function(t){return this.min<=t.min&&this.max>t.max}},{key:"isEmpty",value:function(){return this.min>this.max}},{key:"makeEmpty",value:function(){this.min=Number.POSITIVE_INFINITY,this.max=Number.NEGATIVE_INFINITY}},{key:"length",value:function(){return this.isEmpty()?NaN:this.max-this.min}}],[{key:"intersection",value:function(e,n){var r=new t;return r.min=Math.max(e.min,n.min),r.max=Math.min(e.max,n.max),r.min>r.max&&r.makeEmpty(),r}},{key:"bound",value:function(e,n){var r=new t;return r.min=Math.min(e.min,n.min),r.max=Math.max(e.max,n.max),r}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",function(){return c});var o=n(0),u=n(2),s=n(3),l=(n(1),n(10)),c=function(){function t(e){r(this,t),this.objectLayerJson=e,this.shapes=[];var n=!0,i=!1,a=void 0;try{for(var o,u=e.objects[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;console.log(s),s.polygon?this.addPolygon(s):s.polyline||s.ellipse||s.gid||(s.text,this.addRectangle(s))}}catch(t){i=!0,a=t}finally{try{n||null==u.return||u.return()}finally{if(i)throw a}}this.quadTree=new l.a(this.shapes,5,5)}return a(t,[{key:"addRectangle",value:function(t){var e=t.width,n=t.height,r=new o.a(e,0),i=new o.a(0,n),a=-t.rotation*Math.PI/180;a&&(r=r.rotated(a),i=i.rotated(a));var u={name:t.name,x:t.x,y:t.y,width:t.width,height:t.height,polygon:[{x:0,y:0},r,r.add(i),i],properties:t.properties||{}};this.addPolygon(u)}},{key:"addPolygon",value:function(t){var e=t.polygon.map(function(e){return new o.a(t.x+e.x,t.y+e.y)}),n=u.a.generateConvexPolygons(e),r=!0,i=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;c.name=t.name,this.addConvexPolygon(c,t.properties||{})}}catch(t){i=!0,a=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw a}}}},{key:"addConvexPolygon",value:function(t,e){var n=t.aabb,r={type:"polygon",name:t.name,left:n.left,top:n.top,right:n.right,bottom:n.bottom,polygon:t,properties:e||{},collideWidth:function(t){var e,n,r=t.body,i=new o.a(t.x,t.y),a=r.x,l=r.x+r.width,c=r.y,h=r.y+r.height;r.plus&&r.plus.shape?(n=r.plus.shape.translated(i),e=n.normals.concat(this.polygon.normals)):(n=u.a.fromRectangle(a,c,l,h),e=[new o.a(1,0),new o.a(0,1)].concat(this.polygon.normals));var f,y=Number.POSITIVE_INFINITY,p=!0,v=!1,m=void 0;try{for(var d,b=e[Symbol.iterator]();!(p=(d=b.next()).done);p=!0){var g=d.value,w=this.polygon.projectOntoAxis(g),x=n.projectOntoAxis(g);if(s.a.intersection(w,x).isEmpty())return null;var k=Math.min(Math.abs(w.max-x.min),Math.abs(x.max-w.min));y>k&&(y=k,f=g)}}catch(t){v=!0,m=t}finally{try{p||null==b.return||b.return()}finally{if(v)throw m}}return n.center.sub(this.polygon.center).dot(f)<0&&(f=f.scale(-1)),{penetration:f.scale(-y),normal:f}}};this.shapes.push(r)}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),i=n(14),a=n(15),o=n(16),u=function(t,e){function n(t){return t+"-TilemapPlus"}this.scene=t,this.systems=t.sys,t.sys.settings.isBooted||t.sys.events.once("boot",this.boot,this);var u=this.scene.load.tilemapTiledJSON;this.scene.load.tilemapTiledJSON=function(t,e,r){var i=u.call(this,t,e,r);return this.json(n(t),e),i};var s=this.scene.make.tilemap;this.scene.make.tilemap=function(t){var e=s.call(this,t),i=this.scene.cache.json.get(n(t.key));return e.plus=new r.a(i,this.scene,e),e};var l=Phaser.Tilemaps.Tilemap.prototype.createStaticLayer;Phaser.Tilemaps.Tilemap.prototype.createStaticLayer=function(t,e,n,r){var a=l.call(this,t,e,n,r);return a.plus=new i.a(a),a};var c=Phaser.Tilemaps.Tilemap.prototype.addTilesetImage;Phaser.Tilemaps.Tilemap.prototype.addTilesetImage=function(t,e,n,r,i,o,u){var s=c.call(this,t,e,n,r,i,o,u);return s.plus=new a.a(s),s};var h=this.scene.physics.add.sprite;this.scene.physics.add.sprite=function(t,e,n,r,i){var a=h.call(this,t,e,n,r,i);return a.plus=new o.a(a),a}};u.prototype={init:function(t){},boot:function(){var t=this.systems.events;t.on("start",this.start,this),t.on("preupdate",this.preUpdate,this),t.on("update",this.update,this),t.on("postupdate",this.postUpdate,this),t.on("pause",this.pause,this),t.on("resume",this.resume,this),t.on("sleep",this.sleep,this),t.on("wake",this.wake,this),t.on("shutdown",this.shutdown,this),t.on("destroy",this.destroy,this)},test:function(t){console.log("TilemapPlusPlugin says hello "+t+"!")},start:function(){},preUpdate:function(t,e){},update:function(t,e){},postUpdate:function(t,e){},pause:function(){},resume:function(){},sleep:function(){},wake:function(){},shutdown:function(){},destroy:function(){this.shutdown(),this.scene=void 0}},u.prototype.constructor=u,Phaser.Plugins.TilemapPlus=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return u});var i=n(7),a=n(8),o=n(11),u=function t(e,n,u){r(this,t),this.tilemapJson=e,this.time=n.time,this.tilemap=u,this.timer=null,this.tileAnimations=[],this.game=n.game,this.animation=new i.a(e,n,u),this.events=new o.a(e),this.physics=new a.a(e,this.events),this.properties=e.properties||{}}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function o(t){var e=t.tiles;if(e)for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],a=e[i],o=a.animation;o&&o.length>0&&u.bind(this)(t,i,o)}}function u(t,e,n){var r=n.map(function(t){return{tileId:t.tileid,duration:t.duration}});if(0!==r.length){var i=this.tilemap.tilesets.find(function(e){return e.name===t.name}),a={frames:r,tileset:i,tileLocations:l.bind(this)(i.firstgid+parseInt(e)),currentFrame:0,currentDuration:0};this.tileAnimations.push(a)}}function s(){var t=this.time.elapsedMS,e=!1,n=!0,r=!1,i=void 0;try{for(var a,o=this.tileAnimations[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=u.frames,l=u.tileset,c=u.tileLocations,h=u.currentFrame,f=s[h].duration;if(u.currentDuration+=t,u.currentDuration>f){u.currentDuration-=f,u.currentFrame=(h+1)%s.length;var y=l.firstgid+s[u.currentFrame].tileId,p=!0,v=!1,m=void 0;try{for(var d,b=c[Symbol.iterator]();!(p=(d=b.next()).done);p=!0){var g=d.value;this.tilemap.getTile(g.x,g.y,g.layer,!0).index=y}}catch(t){v=!0,m=t}finally{try{p||null==b.return||b.return()}finally{if(v)throw m}}e=!0}}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}if(e){var w=!0,x=!1,k=void 0;try{for(var N,I=this.tilemap.layers[Symbol.iterator]();!(w=(N=I.next()).done);w=!0){N.value.dirty=!0}}catch(t){x=!0,k=t}finally{try{w||null==I.return||I.return()}finally{if(x)throw k}}}}function l(t){var e=[],n=!0,r=!1,i=void 0;try{for(var a,o=this.tilemapJson.layers[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if("tilelayer"===u.type)for(var s=u.data,l=u.width,c=u.height,h=0;h<c;h++)for(var f=0;f<l;f++)s[h*l+f]===t&&e.push({x:f,y:h,layer:u.name})}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e}n.d(e,"a",function(){return c});var c=function(){function t(e,n,i){r(this,t),this.tilemapJson=e,this.time=n,this.tilemap=i,this.timer=null,this.tileAnimations=[],this.game=n.game}return a(t,[{key:"enable",value:function(){var t=this;if(null==this.timer){var e=!0,n=!1,r=void 0;try{for(var i,a=this.tilemapJson.tilesets[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=i.value;u.tiles&&o.bind(this)(u)}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}this.timer=this.time.events.loop(20,function(){return s.bind(t)()})}}},{key:"disable",value:function(){null!=this.timer&&(this.time.events.remove(this.timer),this.timer=null,this.tileAnimations=[])}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",function(){return l});var o=n(0),u=(n(2),n(3),n(1)),s=n(4),l=function(){function t(e,n){r(this,t),this.tilemapJson=e,this.events=n}return a(t,[{key:"enableObjectLayer",value:function(t){var e=this.tilemapJson.layers.find(function(e){return"objectgroup"===e.type&&e.name===t});if(!e)throw new Error('No object layer found with name "'.concat(t,'"'));this.shapeLayer=new s.a(e)}},{key:"collideWith",value:function(t){if(this.shapeLayer){var e=t.body,n=t.scene.physics.world.gravity,r=new o.a(n.x,n.y),i=(r.normalized(),new o.a(e.velocity.x,e.velocity.y));e.plus||(e.plus={});var a=e.plus;a.contactNormals=[],a.penetrations=[],a.contactNormal||(a.contactNormal=new o.a),a.contactNormal.x=a.contactNormal.y=0;var s=new o.a,l=0,c=new u.a(e.x-1,e.y-1,e.x+e.width+1,e.y+e.height+1),h=this.shapeLayer.quadTree.candidateShapes(c),f=[],y=!0,p=!1,v=void 0;try{for(var m,d=h[Symbol.iterator]();!(y=(m=d.next()).done);y=!0){var b=m.value,g=b.collideWidth(t);if(g){var w=g.normal;if(!(i.dot(w)>=0)){var x=g.penetration;if(new o.a(e.x-e.prev.x,e.y-e.prev.y).sub(x).dot(w)>=-1){var k=b.properties,N=k.collideOnly;if(N){if("down"===N&&(i.y<0||w.y>=0))continue;if("up"===N&&(i.y>0||w.y<=0))continue;if("right"===N&&(i.x<0||w.x>=0))continue;if("left"===N&&(i.x>0||w.x<=0))continue}a.contactNormal=a.contactNormal.add(w),a.contactNormals.push(w),s=s.add(x),a.penetrations.push(x);var I=k.bounce;I&&(l+=I),f.push(b)}}}}}catch(t){p=!0,v=t}finally{try{y||null==d.return||d.return()}finally{if(p)throw v}}e.x-=s.x,e.y-=s.y,a.contactNormal=a.contactNormal.normalized();var T,S=a.contactNormal,E=i.dot(S),P=S.scale(E),M=i.sub(P);T=P.scale(-l);var A=M,L=T.add(A);e.velocity.x=L.x,e.velocity.y=L.y,this.updateBlocked(t),this.events.collisions.notify(t,f,i,L,S)}}},{key:"updateBlocked",value:function(t){var e=t.body,n=e.plus.contactNormal;e.blocked.up=e.blocked.up||n.y>0,e.blocked.down=e.blocked.down||n.y<0,e.blocked.left=e.blocked.left||n.x>0,e.blocked.right=e.blocked.right||n.x<0,e.blocked.none=0==n.x&&0==n.y}}]),t}()},function(t,e){function n(t,e,n){n=n||0;var r,i,a,o,u,s,l,c=[0,0];return r=t[1][1]-t[0][1],i=t[0][0]-t[1][0],a=r*t[0][0]+i*t[0][1],o=e[1][1]-e[0][1],u=e[0][0]-e[1][0],s=o*e[0][0]+u*e[0][1],l=r*u-o*i,P(l,0,n)||(c[0]=(u*a-i*s)/l,c[1]=(r*s-o*a)/l),c}function r(t,e,n,r){var i=e[0]-t[0],a=e[1]-t[1],o=r[0]-n[0],u=r[1]-n[1];if(o*a-u*i==0)return!1;var s=(i*(n[1]-t[1])+a*(t[0]-n[0]))/(o*a-u*i),l=(o*(t[1]-n[1])+u*(n[0]-t[0]))/(u*i-o*a);return s>=0&&s<=1&&l>=0&&l<=1}function i(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function a(t,e,n){return i(t,e,n)>0}function o(t,e,n){return i(t,e,n)>=0}function u(t,e,n){return i(t,e,n)<0}function s(t,e,n){return i(t,e,n)<=0}function l(t,e,n,r){if(r){var a=A,o=L;a[0]=e[0]-t[0],a[1]=e[1]-t[1],o[0]=n[0]-e[0],o[1]=n[1]-e[1];var u=a[0]*o[0]+a[1]*o[1],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]),l=Math.sqrt(o[0]*o[0]+o[1]*o[1]);return Math.acos(u/(s*l))<r}return 0===i(t,e,n)}function c(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function h(t,e){var n=t.length;return t[e<0?e%n+n:e%n]}function f(t){t.length=0}function y(t,e,n,r){for(var i=n;i<r;i++)t.push(e[i])}function p(t){for(var e=0,n=t,r=1;r<t.length;++r)(n[r][1]<n[e][1]||n[r][1]===n[e][1]&&n[r][0]>n[e][0])&&(e=r);return!a(h(t,e-1),h(t,e),h(t,e+1))&&(v(t),!0)}function v(t){for(var e=[],n=t.length,r=0;r!==n;r++)e.push(t.pop());for(var r=0;r!==n;r++)t[r]=e[r]}function m(t,e){return u(h(t,e-1),h(t,e),h(t,e+1))}function d(t,e,r){var i,a,u=O,l=j;if(o(h(t,e+1),h(t,e),h(t,r))&&s(h(t,e-1),h(t,e),h(t,r)))return!1;a=c(h(t,e),h(t,r));for(var f=0;f!==t.length;++f)if((f+1)%t.length!==e&&f!==e&&o(h(t,e),h(t,r),h(t,f+1))&&s(h(t,e),h(t,r),h(t,f))&&(u[0]=h(t,e),u[1]=h(t,r),l[0]=h(t,f),l[1]=h(t,f+1),i=n(u,l),c(h(t,e),i)<a))return!1;return!0}function b(t,e,n){for(var i=0;i!==t.length;++i)if(i!==e&&i!==n&&(i+1)%t.length!==e&&(i+1)%t.length!==n&&r(h(t,e),h(t,n),h(t,i),h(t,i+1)))return!1;return!0}function g(t,e,n,r){var i=r||[];if(f(i),e<n)for(var a=e;a<=n;a++)i.push(t[a]);else{for(var a=0;a<=n;a++)i.push(t[a]);for(var a=e;a<t.length;a++)i.push(t[a])}return i}function w(t){for(var e=[],n=[],r=[],i=[],a=Number.MAX_VALUE,o=0;o<t.length;++o)if(m(t,o))for(var u=0;u<t.length;++u)if(d(t,o,u)){n=w(g(t,o,u,i)),r=w(g(t,u,o,i));for(var s=0;s<r.length;s++)n.push(r[s]);n.length<a&&(e=n,a=n.length,e.push([h(t,o),h(t,u)]))}return e}function x(t){var e=w(t);return e.length>0?k(t,e):[t]}function k(t,e){if(0===e.length)return[t];if(e instanceof Array&&e.length&&e[0]instanceof Array&&2===e[0].length&&e[0][0]instanceof Array){for(var n=[t],r=0;r<e.length;r++)for(var i=e[r],a=0;a<n.length;a++){var o=n[a],u=k(o,i);if(u){n.splice(a,1),n.push(u[0],u[1]);break}}return n}var i=e,r=t.indexOf(i[0]),a=t.indexOf(i[1]);return-1!==r&&-1!==a&&[g(t,r,a),g(t,a,r)]}function N(t){var e,n=t;for(e=0;e<n.length-1;e++)for(var i=0;i<e-1;i++)if(r(n[e],n[e+1],n[i],n[i+1]))return!1;for(e=1;e<n.length-2;e++)if(r(n[0],n[n.length-1],n[e],n[e+1]))return!1;return!0}function I(t,e,n,r,i){i=i||0;var a=e[1]-t[1],o=t[0]-e[0],u=a*t[0]+o*t[1],s=r[1]-n[1],l=n[0]-r[0],c=s*n[0]+l*n[1],h=a*l-s*o;return P(h,0,i)?[0,0]:[(l*u-o*c)/h,(a*c-s*u)/h]}function T(t,e,n,r,i,l,f){l=l||100,f=f||0,i=i||25,e=void 0!==e?e:[],n=n||[],r=r||[];var p=[0,0],v=[0,0],d=[0,0],g=0,w=0,x=0,k=0,N=0,S=0,E=0,P=[],M=[],A=t,L=t;if(L.length<3)return e;if(++f>l)return console.warn("quickDecomp: max level ("+l+") reached."),e;for(var O=0;O<t.length;++O)if(m(A,O)){n.push(A[O]),g=w=Number.MAX_VALUE;for(var j=0;j<t.length;++j)a(h(A,O-1),h(A,O),h(A,j))&&s(h(A,O-1),h(A,O),h(A,j-1))&&(d=I(h(A,O-1),h(A,O),h(A,j),h(A,j-1)),u(h(A,O+1),h(A,O),d)&&(x=c(A[O],d))<w&&(w=x,v=d,S=j)),a(h(A,O+1),h(A,O),h(A,j+1))&&s(h(A,O+1),h(A,O),h(A,j))&&(d=I(h(A,O+1),h(A,O),h(A,j),h(A,j+1)),a(h(A,O-1),h(A,O),d)&&(x=c(A[O],d))<g&&(g=x,p=d,N=j));if(S===(N+1)%t.length)d[0]=(v[0]+p[0])/2,d[1]=(v[1]+p[1])/2,r.push(d),O<N?(y(P,A,O,N+1),P.push(d),M.push(d),0!==S&&y(M,A,S,A.length),y(M,A,0,O+1)):(0!==O&&y(P,A,O,A.length),y(P,A,0,N+1),P.push(d),M.push(d),y(M,A,S,O+1));else{if(S>N&&(N+=t.length),k=Number.MAX_VALUE,N<S)return e;for(var j=S;j<=N;++j)o(h(A,O-1),h(A,O),h(A,j))&&s(h(A,O+1),h(A,O),h(A,j))&&(x=c(h(A,O),h(A,j)))<k&&b(A,O,j)&&(k=x,E=j%t.length);O<E?(y(P,A,O,E+1),0!==E&&y(M,A,E,L.length),y(M,A,0,O+1)):(0!==O&&y(P,A,O,L.length),y(P,A,0,E+1),y(M,A,E,O+1))}return P.length<M.length?(T(P,e,n,r,i,l,f),T(M,e,n,r,i,l,f)):(T(M,e,n,r,i,l,f),T(P,e,n,r,i,l,f)),e}return e.push(t),e}function S(t,e){for(var n=0,r=t.length-1;t.length>3&&r>=0;--r)l(h(t,r-1),h(t,r),h(t,r+1),e)&&(t.splice(r%t.length,1),n++);return n}function E(t,e){for(var n=t.length-1;n>=1;--n)for(var r=t[n],i=n-1;i>=0;--i)M(r,t[i],e)&&t.splice(n,1)}function P(t,e,n){return n=n||0,Math.abs(t-e)<=n}function M(t,e,n){return P(t[0],e[0],n)&&P(t[1],e[1],n)}t.exports={decomp:x,quickDecomp:T,isSimple:N,removeCollinearPoints:S,removeDuplicatePoints:E,makeCCW:p};var A=[],L=[],O=[],j=[]},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",function(){return u});var o=(n(0),n(1)),u=function(){function t(e,n,i){if(r(this,t),this.maxLevel=n,this.maxShapes=i,e.length<i||n<=1)this.shapes=e;else{var a=o.a.fromAABBs(e.map(function(t){return t.polygon.aabb})),u=a.center();this.pivot=u;var s=[],l=[],c=[],h=[],f=[],y=!0,p=!1,v=void 0;try{for(var m,d=e[Symbol.iterator]();!(y=(m=d.next()).done);y=!0){var b=m.value,g=b.polygon.aabb;g.right<u.x&&g.bottom<u.y?l.push(b):g.left>u.x&&g.bottom<u.y?c.push(b):g.right<u.x&&g.top>u.y?h.push(b):g.left>u.x&&g.top>u.y?f.push(b):s.push(b)}}catch(t){p=!0,v=t}finally{try{y||null==d.return||d.return()}finally{if(p)throw v}}this.shapes=s,l.length>0&&(this.topLeftNode=new t(l,n-1,i)),c.length>0&&(this.topRightNode=new t(c,n-1,i)),h.length>0&&(this.bottomLeftNode=new t(h,n-1,i)),f.length>0&&(this.bottomRightNode=new t(f,n-1,i))}}return a(t,[{key:"candidateShapes",value:function(t){var e=this.shapes.filter(function(e){return e.polygon.aabb.intersects(t)}),n=this.pivot;if(!n)return e;var r=this.topLeftNode;r&&t.left<=n.x&&t.top<=n.y&&(e=e.concat(r.candidateShapes(t)));var i=this.topRightNode;i&&t.right>=n.x&&t.top<=n.y&&(e=e.concat(i.candidateShapes(t)));var a=this.bottomLeftNode;a&&t.left<=n.x&&t.bottom>=n.y&&(e=e.concat(a.candidateShapes(t)));var o=this.bottomRightNode;return o&&t.right>=n.x&&t.bottom>=n.y&&(e=e.concat(o.candidateShapes(t))),e}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var i=n(12),a=n(13),o=function t(e){r(this,t),this.collisions=new i.a,this.regions=new a.a(e)}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",function(){return o});var o=function(){function t(){r(this,t),this.spriteListeners=new Map,this.spriteCollisions=new Map}return a(t,[{key:"add",value:function(t,e){return this.getSpriteListeners(t).push(e),e}},{key:"remove",value:function(t,e){var n=this.getSpriteListeners(t);this.spriteListeners.set(t,n.filter(function(t){return t!=e}))}},{key:"notify",value:function(t,e,n,r,i){var a=this.spriteCollisions.has(t)?this.spriteCollisions.get(t):[],o=e.filter(function(t){return!a.find(function(e){return e===t})});this.spriteCollisions.set(t,e);var u=!0,s=!1,l=void 0;try{for(var c,h=o[Symbol.iterator]();!(u=(c=h.next()).done);u=!0){var f=c.value,y=!0,p=!1,v=void 0;try{for(var m,d=this.getSpriteListeners(t)[Symbol.iterator]();!(y=(m=d.next()).done);y=!0){(0,m.value)(f,n,r,i)}}catch(t){p=!0,v=t}finally{try{y||null==d.return||d.return()}finally{if(p)throw v}}}}catch(t){s=!0,l=t}finally{try{u||null==h.return||h.return()}finally{if(s)throw l}}}},{key:"getSpriteListeners",value:function(t){return this.spriteListeners.has(t)||this.spriteListeners.set(t,[]),this.spriteListeners.get(t)}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",function(){return s});var o=(n(0),n(2),n(3),n(1)),u=n(4),s=function(){function t(e){r(this,t),this.tilemapJson=e,this.spriteStates=new Map}return a(t,[{key:"enableObjectLayer",value:function(t){var e=this.tilemapJson.layers.find(function(e){return"objectgroup"===e.type&&e.name===t});if(!e)throw new Error('No object layer found with name "'.concat(t,'"'));this.shapeLayer=new u.a(e)}},{key:"onEnterAdd",value:function(t,e){return this.getSpriteState(t).enterListeners.push(e),e}},{key:"onEnterRemove",value:function(t,e){var n=this.getSpriteState(t);n.enterListeners=n.enterListeners.filter(function(t){return t!=e})}},{key:"onLeaveAdd",value:function(t,e){return this.getSpriteState(t).leaveListeners.push(e),e}},{key:"onLeaveRemove",value:function(t,e){var n=this.getSpriteState(t);n.leaveListeners=n.leaveListeners.filter(function(t){return t!=e})}},{key:"triggerWith",value:function(t){if(this.shapeLayer){var e=t.body,n=new o.a(e.x-1,e.y-1,e.x+e.width+1,e.y+e.height+1),r=this.shapeLayer.quadTree.candidateShapes(n),i=[],a=!0,u=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var h=l.value;h.collideWidth(e)&&i.push(h)}}catch(t){u=!0,s=t}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}this.notify(t,i)}}},{key:"notify",value:function(t,e){var n=this.getSpriteState(t),r=n.collisions,i=e.filter(function(t){return!r.find(function(e){return e===t})}),a=r.filter(function(t){return!e.find(function(e){return e===t})});n.collisions=e;var o=!0,u=!1,s=void 0;try{for(var l,c=i[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var h=l.value,f=!0,y=!1,p=void 0;try{for(var v,m=n.enterListeners[Symbol.iterator]();!(f=(v=m.next()).done);f=!0){(0,v.value)(h)}}catch(t){y=!0,p=t}finally{try{f||null==m.return||m.return()}finally{if(y)throw p}}}}catch(t){u=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}var d=!0,b=!1,g=void 0;try{for(var w,x=a[Symbol.iterator]();!(d=(w=x.next()).done);d=!0){var k=w.value,N=!0,I=!1,T=void 0;try{for(var S,E=n.leaveListeners[Symbol.iterator]();!(N=(S=E.next()).done);N=!0){(0,S.value)(k)}}catch(t){I=!0,T=t}finally{try{N||null==E.return||E.return()}finally{if(I)throw T}}}}catch(t){b=!0,g=t}finally{try{d||null==x.return||x.return()}finally{if(b)throw g}}}},{key:"getSpriteState",value:function(t){return this.spriteStates.has(t)||this.spriteStates.set(t,{collisions:[],enterListeners:[],leaveListeners:[]}),this.spriteStates.get(t)}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return i});var i=function t(e){r(this,t),this.properties=e.layer.properties||{}}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return i});var i=function t(e){r(this,t),this.properties=e.properties||{}}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",function(){return u});var o=n(2),u=function(){function t(e){r(this,t),this.sprite=e}return a(t,[{key:"setBodyCapsule",value:function(t,e,n){var r=this.sprite;if(!r.body)throw new Error("Enable arcade physics before assigning body shape");var i=r.body;i.plus=i.plus||{};var a=.5*t,u=.5*e;i.plus.shape=o.a.fromCapsule(-a,-u,+a,+u,n)}}]),t}()}]);